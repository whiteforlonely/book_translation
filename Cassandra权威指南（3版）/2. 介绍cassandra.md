
# 第二章 介绍Cassandra

*一项发明必须是在它的世界完成时有意义，而不是在世界开始的时候。*
***Ray Kurzweil***

在之前的章节中，我们讨论了为了应对不断新增的当代世界网络伸缩应用的新需求而出现的非关系型数据库。在这一章中，我们将聚焦在Cassandra有价值的提议和关键信条来说明他们是如何提升了Cassandra的竞争力，你同样将会学习到Cassandra的历史，并且你将会知道如果通过开源社区来维护Cassandra.

## Cassandra的“电梯游说”
好莱坞的剧作家和软件企业家经常被建议准备好他们的“电梯游说”。这其实是说他们的产品足够简单，清晰到只需要一两分钟便足以说明，并且刚好幸运的是有一个有意向投资他们的发明的一个高管，或代理，或投资者刚好正在和他们使用同一个电梯。Cassandra具有一个有说服力的故事，这就让我们把它炸成电梯游说以至于需要的时候，你可以将它向你的管理或者同时说明。

### 50个单词来说明Cassandra
Apache Cassandra是一个分布开源，去中心化，可升级扩展，高可用，容错，和谐一致，面向行的数据库。它是基于亚马逊的Dynamo的分布式设计和Google的Bigtable的数据模型进行开发，支持类似SQL的查询语言。它始于Facebook，现在为许多行业的云计算应用程序提供了动力。事实上刚好是50个单词（英文原文是50个单词）。

当然，如果你再电梯里卖弄向你的老板做如上简述，可能会招到白眼，所以让我们在下面的章节中分解关键点。

### 分布式和去中心化
Cassandra是分布式的，这意味着，它能够同时运行在多个机器上，并且对外给用户看到的是一个统一的整体，事实上，运行单个节点对Cassandra没有什么意义。虽然你可以这样子做，以用来加快它的运行速度，但是你很快就会发现你需要运行多台机器来实现运行Cassandra的任何好处。它的大部分设计和代码库都是专门设计的，目的不仅仅是让它在许多不同的机器上工作，并且也用于优化跨多个数据中心机架的性能，甚至对于单个Cassandra集群，它可以运行在地理分散的数据中心。你可以很放心的写入数据到集群中的任何一个地方并且Cassandra也将会获取到。

你之前开始扩展许多其他的数据存储（MYSQL, Bigtable），有一些节点需要设置为主副本以让它管理其他的次要副本节点。然后Cassnadra是去中心化的，意味着每个节点都是相同的；没有哪一个Cassandra节点是扮演组织其他节点的中心。相反的，Cassandra提供一个端对端的架构，并且通过gossip协议去维护和同步一组或是存活，或是宕掉的节点。我们将会在108页的"Gossip和失败检测"作进一步 的讨论。

事实上去中心化的Cassandra也意味着不会出现单点故障的问题。所有Cassandra集群中的节点都表现一致，有时候这种行为被称为“服务对称”，因为他们总是做同样的事情，因此也不会有一个特别的主机来协调活动（例如MYSQL, Bigtableh和许多其他的数据库需要设置主从节点）。

在许多分布式数据解决方案（例如关系型数据库管理系统集群），你会在一个服务的一个进程中设置多个数据的拷贝，称为服务，用来拷贝数据到多个机器上以至于所有的机器都能够同时服务请求并提高性能。通常这个过程不是像Cassandra这样子分散的，而是通过定义主从关系来表现的。因此集群中的所有服务并不能表现一致，你通过配置设置集群中的一台服务为主服务，而其他集群中的服务为从服务节点，主副本充当数据的权威来源，并和必须同步数据的从副本以单向关系运行，如果主节点挂掉，那么整个数据库将是危险的。要解决单个主节点导致的单节点故障的情况，需要在环境中以设置多个主节点的方式来增加复杂度。基于我们对关系型数据库中的主从副本的认识，这对于MongoDB这样的noSQL，同样也是基于主从副本。即使是Mongo的“复制集”机制也本质上是一个主/从方案，其中主方案可以被一个自动配对的leader选举过程所取代

因此，去中心化有两个好处，他比主/从方案更容易使用，并且它可以避免你服务的中断。因为所有的节点都是一样的，所以去中心化的存储比主/从存储更容易操作，这也意味着，你不需要任何特别的扩容技术，部署50个节点和部署一个节点的复杂性没有什么区分。几乎不需要任何配置去支持它，因为在Cassandra中的所有副本都是一样的，所以一个节点的失败并不会导致服务的终止。

简单的说，就是Cassandra是分布式和去中心化的，所以没有单点故障的存在，也就是他是支持高可用的。

